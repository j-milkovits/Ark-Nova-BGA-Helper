(()=>{var C=class{constructor(){this.state={playerNames:{yourName:null,opponentName:null},opponentTrackedCards:[]},this.callbacks=[]}onStateChange(t){this.callbacks.push(t)}notifyStateChange(){this.callbacks.forEach(t=>t(this))}async loadState(){return new Promise(t=>{chrome.storage.local.get("trackerState",r=>{r.trackerState&&(this.state=r.trackerState),t(this.state),this.notifyStateChange()})})}saveState(){chrome.storage.local.set({trackerState:this.state},()=>{this.notifyStateChange()})}updatePlayerNames(t,r){this.state.playerNames={yourName:t,opponentName:r},this.saveState()}addOpponentTrackedCard(t){this.state.opponentTrackedCards.includes(t)||(this.state.opponentTrackedCards.push(t),this.saveState())}removeOpponentTrackedCard(t){let r=this.state.opponentTrackedCards.indexOf(t);r!==-1&&(this.state.opponentTrackedCards.splice(r,1),this.saveState())}clearOpponentTrackedCards(){this.state.opponentTrackedCards=[],this.saveState()}getState(){return this.state}getOpponentName(){return this.state.playerNames.opponentName}getYourName(){return this.state.playerNames.yourName}getOpponentTrackedCards(){return this.state.opponentTrackedCards}},c=new C;function R(){let e=document.createElement("div");e.id="card-tracker-container",e.style.position="fixed",e.style.top="50%",e.style.right="10px",e.style.transform="translateY(65%)",e.style.backgroundColor="#f9f9f9",e.style.border="1px solid #ddd",e.style.borderRadius="10px",e.style.padding="15px",e.style.zIndex="10000",e.style.width="280px",e.style.boxShadow="0 4px 8px rgba(0, 0, 0, 0.2)",e.style.fontFamily="Arial, sans-serif",e.style.fontSize="14px";let t=document.createElement("div");t.style.cursor="move",t.style.backgroundColor="#ddd",t.style.padding="10px",t.style.textAlign="center",t.style.borderBottom="1px solid #ccc",t.style.borderRadius="10px",t.textContent="Card Tracker",e.appendChild(t);let r=document.createElement("div");r.innerHTML=`
    <div id="tracker-list" style="max-height: 250px; overflow-y: auto; border: 1px solid #ddd; border-radius: 8px; padding: 10px; background-color: #fff;">
      <p style="text-align: center; color: #999;">No cards tracked yet.</p>
    </div>
    <div style="margin-top: 15px; display: flex; justify-content: space-between;">
      <button id="add-card-btn" style="
        background-color: #4CAF50;
        color: white;
        border: none;
        border-radius: 5px;
        padding: 8px 12px;
        cursor: pointer;
        font-size: 14px;
      ">
        Add Card
      </button>
      <button id="clear-cards-btn" style="
        background-color: #f44336;
        color: white;
        border: none;
        border-radius: 5px;
        padding: 8px 12px;
        cursor: pointer;
        font-size: 14px;
      ">
        Clear All
      </button>
    </div>
  `,e.appendChild(r),document.body.appendChild(e),X(e,t);let o=e.querySelector("#add-card-btn"),a=e.querySelector("#tracker-list");o.addEventListener("click",()=>{let s=prompt("Enter card name:");s&&c.addOpponentTrackedCard(s)}),e.querySelector("#clear-cards-btn").addEventListener("click",()=>{c.clearOpponentTrackedCards()})}function N(){let e=c.getOpponentTrackedCards(),t=document.querySelector("#tracker-list");t&&(t.innerHTML="",e.length>0?e.forEach(r=>{let o=document.createElement("div");o.style.display="flex",o.style.justifyContent="space-between",o.style.alignItems="center",o.style.border="1px solid #ddd",o.style.borderRadius="4px",o.style.padding="5px",o.style.marginBottom="5px",o.style.backgroundColor="#f9f9f9";let a=document.createElement("span");a.textContent=r;let n=J();n.addEventListener("click",()=>{c.removeOpponentTrackedCard(r)}),o.appendChild(a),o.appendChild(n),t.appendChild(o)}):t.innerHTML='<p style="text-align: center; color: #666;">No cards tracked yet.</p>')}function X(e,t){let r=!1,o=0,a=0;t.addEventListener("mousedown",n=>{r=!0;let s=e.getBoundingClientRect();o=n.clientX-s.left,a=n.clientY-s.top,document.body.style.cursor="grabbing"}),document.addEventListener("mousemove",n=>{if(!r)return;let s=n.clientX-o,i=n.clientY-a;e.style.left=`${s}px`,e.style.top=`${i}px`,e.style.transform=""}),document.addEventListener("mouseup",()=>{r&&(r=!1,document.body.style.cursor="default")})}function J(){let e=document.createElement("button");return e.textContent="\xD7",e.style.backgroundColor="white",e.style.color="#f44336",e.style.border="none",e.style.borderRadius="50%",e.style.width="24px",e.style.height="24px",e.style.cursor="pointer",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.style.fontWeight="bold",e.style.fontSize="16px",e.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.2)",e.style.transition="transform 0.2s ease, background-color 0.2s ease",e.addEventListener("mouseenter",()=>{e.style.transform="scale(1.2)",e.style.backgroundColor="#fddcdc"}),e.addEventListener("mouseleave",()=>{e.style.transform="scale(1)",e.style.backgroundColor="transparent"}),e}var v=class{constructor(){this.events={}}subscribe(t,r){this.events[t]||(this.events[t]=[]),this.events[t].push(r)}unsubscribe(t,r){this.events[t]&&(this.events[t]=this.events[t].filter(o=>o!==r))}publish(t,r){console.log("publishing event ",t,r),this.events[t]&&this.events[t].forEach(o=>o(r))}},p=new v;var w="Rock",q="Water",O="Herbivore",I="Bird",B="Primate";var l="DRAW",f="PLAY",k="SKIP",m="START",g="END",E="RESISTANCE";var Z=[{regex:/^(.*) is now/,action:k},{regex:/^You draw (.*) from the deck \(scoring cards\)/,action:m},{regex:/^The end of the game: (.*) wins!/,action:g},{regex:/^(.*) takes (.*) in reputation range from the display/,action:l},{regex:/^(.*) snaps (.*) from the display/,action:l},{regex:/^(.*) draws (.*) sponsor/,action:l},{regex:/^(.*) draws 1 .*: (.*)/,action:l},{regex:/keeps 1 scoring card and discard 1 scoring card for resistance effect/,action:E},{regex:/^(.*) keeps (.*?) card/,action:l},{regex:/^(.*) takes (.*?) from the display/,action:l},{regex:/^(.*) plays (.*) for/,action:f},{regex:/^(.*) plays a new conservation project: (.*)/,action:f},{regex:/^(.*) plays (.*)/,action:f}];function ee(e){for(let{regex:t,action:r}of Z){let o=e.match(t);if(o){if(r===k)return;if(r===m){p.publish(m);return}if(r===g){p.publish(g);return}if(r===E)return;let a=o[1]?o[1].trim():void 0;(o[2]?o[2].trim():void 0).split(",").forEach(s=>{s=s.trim(),isNaN(s)&&(r===l&&p.publish(l,{playerName:a,cardName:s}),r===f&&p.publish(f,{playerName:a,cardName:s}))});return}}}function j(){let e=document.querySelector("#logs");if(!e)return;new MutationObserver(r=>{r.forEach(o=>{o.addedNodes.length>0&&o.addedNodes.forEach(a=>{if(a.nodeType===Node.ELEMENT_NODE){a.querySelectorAll(".timestamp").forEach(s=>s.remove());let n=a.textContent.trim().replace(/\n|\r/g,"");console.log(n),ee(n)}})})}).observe(e,{childList:!0,subtree:!1})}function M(){let e=document.querySelectorAll(".player-name"),t=e?e[0]:null,r=e?e[1]:null,o=t?t.textContent.trim():null,a=r?r.textContent.trim():null;c.updatePlayerNames(o,a)}function b(e,t=300){let r;return function(...o){clearTimeout(r),r=setTimeout(()=>e.apply(this,o),t)}}function D(){let e=[];document.querySelectorAll("#base-projects-holder .project-holder").forEach(s=>{let i=s.querySelector(".badge-icon");if(i){let d=i.getAttribute("data-type");d&&e.push({type:"BASE",projectType:d})}});function r(s){let i=s.querySelector(".badge-icon"),d=s.querySelector(".icon-partner-zoo"),S=s.querySelector(".icon-release-animal");if(i){let h=i.getAttribute("data-type");h&&(d&&e.push({type:"PROG",projectType:h}),S&&e.push({type:"RELEASE",projectType:h}))}}return document.querySelectorAll("#projects-holder .project-holder").forEach(r),document.querySelectorAll("#cards-pool .project-card").forEach(r),document.querySelectorAll(".player-board-hand .project-card").forEach(r),e}var A={Aquarium:[q],CableCar:[w],Vetenarian:[],MeerkatDen:[O],PenguinPool:[I],BaboonRock:[B]};function W(){let e=document.querySelectorAll(".player-board-inPlay-sponsors"),t=e[0],r=e[1];return{yourBoard:t,opponentBoard:r}}function z(){let{yourBoard:e,opponentBoard:t}=W(),r=e.querySelectorAll(".sponsor-card"),o=[];return r.forEach(a=>{let n=T(a);o.push(n)}),o}function _(){let{yourBoard:e,opponentBoard:t}=W(),r=t.querySelectorAll(".sponsor-card"),o=[];return r.forEach(n=>{let s=T(n);o.push(s)}),e.querySelectorAll(".sponsor-card").forEach(n=>{let s=T(n);o.push(s)}),o}function T(e){let r=(e.id||"").match(/^card-[^_]+_(.+)$/);return r?r[1]:null}function H(){let e=[];return _().forEach(r=>{r in A&&(e=[...e,...A[r]])}),e}function P(e){let t=e.querySelector(".ark-card-top-right");if(!t)return[];let r=t.querySelectorAll(".badge-icon"),o=new Set(Array.from(r).map(n=>n.getAttribute("data-type"))),a=e.querySelector(".ark-card-top-left");if(a){let n=a.querySelector(".icon-enclosure-regular-water, .icon-enclosure-regular-water-water, .icon-enclosure-regular-rock, .icon-enclosure-regular-rock-rock");n&&(n.classList.contains("icon-enclosure-regular-water")&&o.add("Water"),n.classList.contains("icon-enclosure-regular-water-water")&&o.add("Water"),n.classList.contains("icon-enclosure-regular-rock")&&o.add("Rock"),n.classList.contains("icon-enclosure-regular-rock-rock")&&o.add("Rock"))}return Array.from(o)}function te(e,t){let r=P(e),o=[];for(let a of t)r.includes(a.projectType)&&o.push(a);return o}function re(e,t){let r=P(e),o=[];for(let a of t)r.includes(a)&&o.push({type:"SPONSOR"});return o}function oe(e,t){[".card-pool-folder .ark-card",".player-board-hand .ark-card"].forEach(o=>{document.querySelectorAll(o).forEach(n=>{if(n.getAttribute("data-unmarked")==="true")return;let s=te(n,e),i=re(n,t),d=[...s,...i];ne(n,d)})})}function ne(e,t){let r=e.querySelector(".tag-container");if(r&&r.remove(),!t.length){U(e);return}se(e),ce(e),r=document.createElement("div"),r.className="tag-container",r.style.position="absolute",r.style.top="50%",r.style.left="50%",r.style.transform="translate(-50%, -50%)",r.style.display="flex",r.style.flexDirection="column",r.style.alignItems="center",e.style.position="relative",e.appendChild(r),t.forEach(o=>{let a=ae(o.type,o.type);r.appendChild(a)})}var F={DEFAULT:"#9E9E9E",BASE:"#4CAF50",RELEASE:"#FF0000",PROG:"#FFA500",SPONSOR:"#0000FF"};function ae(e,t){let r=F[t]||F.DEFAULT,o=document.createElement("div");return o.textContent=e,o.className="tag-container-badge-matching-project",o.style.backgroundColor=r,o.style.color="white",o.style.borderRadius="12px",o.style.padding="5px 10px",o.style.marginBottom="4px",o.style.fontSize="14px",o.style.fontWeight="bold",o.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.2)",o.style.pointerEvents="none",o}function L(){let e=D(),t=H();oe(e,t)}function Y(){["#cards-pool",".player-board-hand"].forEach(r=>{let o=document.querySelector(r);if(o){let a=b(()=>{n.disconnect(),L(),setTimeout(()=>{n.observe(o,{childList:!0,subtree:!0})},300)}),n=new MutationObserver(s=>{s.filter(d=>{let S=d.target.classList.contains("card-overlay"),h=d.target.classList.contains("tag-container"),Q=d.target.classList.contains("tag-container-badge");return!(S||h||Q)}).length>0&&a()});n.observe(o,{childList:!0,subtree:!0})}}),[".player-board-cards"].forEach(r=>{let o=document.querySelector(r);o&&new MutationObserver(n=>{n.forEach(s=>{s.addedNodes.length>0&&s.addedNodes.forEach(i=>{i.classList&&i.classList.contains("ark-card")&&G(i)})})}).observe(o,{childList:!0,subtree:!0})})}function se(e){if(e.querySelector(".card-overlay"))return;e.style.position="relative";let t=document.createElement("div");t.className="card-overlay",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.right="0",t.style.bottom="0",t.style.border="3px solid yellow",t.style.pointerEvents="none",t.style.borderRadius="inherit",t.style.boxSizing="border-box",e.appendChild(t)}function U(e){let t=e.querySelector(".card-overlay");if(t)t.remove();else return}function ce(e){let t=e.querySelector(".unmark-button");t||(t=document.createElement("button"),t.textContent="\xD7",t.className="unmark-button",t.style.position="absolute",t.style.top="30%",t.style.right="10px",t.style.transform="translateY(-50%)",t.style.backgroundColor="Orange",t.style.color="white",t.style.border="none",t.style.borderRadius="50%",t.style.width="20px",t.style.height="20px",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.fontSize="16px",t.style.cursor="pointer",t.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.2)",t.style.zIndex="1000",t.addEventListener("click",r=>{r.stopPropagation(),le(e)}),e.appendChild(t))}function ie(e){let t=e.querySelector(".unmark-button");if(t)t.remove();else return}function le(e){G(e),e.setAttribute("data-unmarked","true")}function G(e){let t=e.querySelector(".tag-container");t&&t.remove(),U(e),ie(e)}var x=class{constructor(){p.subscribe(l,this.handleCardDrawn.bind(this)),p.subscribe(f,this.handleCardPlayed.bind(this)),p.subscribe(m,this.handleGameStart.bind(this)),p.subscribe(g,this.handleGameEnd.bind(this))}handleCardDrawn({playerName:t,cardName:r}){t===c.getOpponentName()&&c.addOpponentTrackedCard(r)}handleCardPlayed({playerName:t,cardName:r}){t===c.getOpponentName()&&c.removeOpponentTrackedCard(r)}handleGameStart(){c.clearOpponentTrackedCards()}handleGameEnd(){c.clearOpponentTrackedCards()}};function u(e){let t=document.querySelector(e);return t?t.id.split("-")[2]:null}function y(e,t,r){t&&(e[t]||(e[t]=[]),e[t].push(r))}function de(e){return Object.keys(e).reduce((t,r)=>{let o=document.querySelector(`#player_name_${r} a`);return o&&(t[r]={id:r,name:o.innerHTML,color:o.style.color}),t},{})}function pe([e,t],r){let o=r[e];if(!o)return"";let{name:a,color:n}=o;return`<div><span style="font-weight:600;color:${n};">${a}:</span> ${t.join(", ")}</div>`}function ue(){let e={};y(e,u(".player-board-inPlay-sponsors:has(#card-S203_Veterinarian)"),"Veterinarian"),y(e,u(".player-board-inPlay-sponsors:has(#card-S225_QuarantineLab)"),"Quarantine Lab"),y(e,u(".player-board-inPlay-sponsors:has(#card-S241_Hydrologist)"),"Hydrologist"),y(e,u(".player-board-inPlay-sponsors:has(#card-S242_Geologist)"),"Geologist"),y(e,u(".player-board-inPlay-sponsors:has(#card-S228_WazaSmallAnimalProgram)"),"Waza Small"),y(e,u(".player-board-inPlay-sponsors:has(#card-S263_WazaLargeAnimalProgram)"),"Waza Large"),y(e,u(".player-board-inPlay-sponsors:has(#card-S227_WazaSpecialAssignment)"),"Waza Special Assignment"),y(e,u(".player-board-inPlay-sponsors:has(#card-S262_Explorer)"),"Explorer"),y(e,u(".player-board-inPlay-sponsors:has(#card-S219_DiversityResearcher)"),"Diversity Researcher");let t=de(e),r=Object.entries(e).map(o=>pe(o,t)).filter(Boolean).join("");return r?`
    <div style="
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 100%;
      gap: 6px;
      text-align: center;
      padding: 4px 0;
    ">
      ${r}
    </div>
  `:""}function $(){let e=document.querySelector("#reminder-box"),t=ue();if(!t){e&&e.remove();return}if(!e){let r=document.querySelector("#page-title");if(!r)return;r.insertAdjacentHTML("afterend",`<div id="reminder-box"
            style="margin-top:8px;background-color:#f0f0f0;box-shadow:0 3px 8px rgba(0,0,0,.3);
                   padding:8px 0;display:flex;flex-direction:row;align-items:center;"></div>`),e=document.querySelector("#reminder-box")}e.innerHTML=t}function K(){$();let e=b($,300),t=[document.querySelector("#page-title"),...document.querySelectorAll(".player-board-inPlay-sponsors"),...document.querySelectorAll('[id^="player_name_"]')].filter(Boolean),r=new MutationObserver(()=>e());t.forEach(a=>r.observe(a,{childList:!0,subtree:!0,attributes:!0}));let o=setInterval(e,5e3);return()=>{r.disconnect(),clearInterval(o)}}function V(){c.loadState(),c.onStateChange(N),cardTracker=new x,R(),setTimeout(()=>{M(),L(),j(),Y(),z(),K()},1e3)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{V(c)}):V(c);})();
//# sourceMappingURL=bundledContent.js.map
